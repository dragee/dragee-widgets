!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).DrageeWidgets={})}(this,(function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}function o(t){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},o(t)}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=o(t);if(e){var r=o(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return a(this,n)}}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var i,r,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=c(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function g(t,e){var n,i,r=document.createElement("canvas");return"static"===window.getComputedStyle(t).position&&(t.style.position="relative"),r.setAttribute("width",e.size.x+"px"),r.setAttribute("height",e.size.y+"px"),function(t,e){e=e||{};var n="";for(var i in e)e.hasOwnProperty(i)&&(n+=i+": "+e[i]+"; ");t.style.cssText=n}(r,{position:"absolute",left:e.position.y+"px",top:e.position.y+"px",width:e.size.x+"px",height:e.size.y+"px"}),i=r,(n=t).firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),r}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function y(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}function x(t,e){return x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},x(t,e)}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function P(t,e,n){return P=w()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&x(r,n.prototype),r},P.apply(null,arguments)}function E(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function D(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return E(t)}function k(t){var e=w();return function(){var n,i=b(t);if(e){var r=b(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return D(this,n)}}function _(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var i,r,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}(t,e)||A(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t){return function(t){if(Array.isArray(t))return O(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||A(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,e){if(t){if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function T(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=A(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}var M=function(){function t(e,n){v(this,t),this.x=e,this.y=n}return y(t,[{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"mult",value:function(e){return new t(this.x*e,this.y*e)}},{key:"negative",value:function(){return new t(-this.x,-this.y)}},{key:"compare",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"toString",value:function(){return"{x=".concat(this.x,",y=").concat(this.y)}}],[{key:"elementOffset",value:function(e,n){n=n||e.parentNode;var i=e.getBoundingClientRect(),r=n.getBoundingClientRect();return new t(i.left-r.left,i.top-r.top)}},{key:"elementSize",value:function(e){var n=e.getBoundingClientRect();return new t(n.width,n.height)}}]),t}(),R=function(){function t(e,n){v(this,t),this.position=e,this.size=n}return y(t,[{key:"getP1",value:function(){return this.position}},{key:"getP2",value:function(){return new M(this.position.x+this.size.x,this.position.y)}},{key:"getP3",value:function(){return this.position.add(this.size)}},{key:"getP4",value:function(){return new M(this.position.x,this.position.y+this.size.y)}},{key:"getCenter",value:function(){return this.position.add(this.size.mult(.5))}},{key:"or",value:function(e){var n=new M(Math.min(this.position.x,e.position.x),Math.min(this.position.y,e.position.y));return new t(n,new M(Math.max(this.position.x+this.size.x,e.position.x+e.size.x),Math.max(this.position.y+this.size.y,e.position.y+e.size.y)).sub(n))}},{key:"and",value:function(e){var n=new M(Math.max(this.position.x,e.position.x),Math.max(this.position.y,e.position.y)),i=new M(Math.min(this.position.x+this.size.x,e.position.x+e.size.x),Math.min(this.position.y+this.size.y,e.position.y+e.size.y)).sub(n);return i.x<=0||i.y<=0?null:new t(n,i)}},{key:"includePoint",value:function(t){return!(this.position.x>t.x||this.position.x+this.size.x<t.x||this.position.y>t.y||this.position.y+this.size.y<t.y)}},{key:"includeRectangle",value:function(t){return this.includePoint(t.position)&&this.includePoint(t.getP3())}},{key:"moveToBound",value:function(t,e){var n,i;if(e)n=e;else{if(!(i=this.and(t)))return t;n=i.size.x>i.size.y?"y":"x"}var r=this.getCenter(),o=t.getCenter(),s=(r[n]>o[n]?-1:1)>0?this.position[n]+this.size[n]-t.position[n]:this.position[n]-(t.position[n]+t.size[n]);return t.position[n]=t.position[n]+s,t}},{key:"getSquare",value:function(){return this.size.x*this.size.y}},{key:"styleApply",value:function(t){(t=t||document.querySelector("ind")).style.left=this.position.x+"px",t.style.top=this.position.y+"px",t.style.width=this.size.x+"px",t.style.height=this.size.y+"px"}},{key:"growth",value:function(t){this.size=this.size.add(t),this.position=this.position.add(t.mult(-.5))}},{key:"getMinSide",value:function(){return Math.min(this.size.x,this.size.y)}}],[{key:"fromElement",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.parentNode,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=M.elementOffset(e,n,i),o=M.elementSize(e);return new t(r,o)}}]),t}();function L(t){for(var e=t.parentNode;e.parentNode&&"static"===window.getComputedStyle(e).position&&"BODY"!==e.tagName;)e=e.parentNode;return e}var z=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(v(this,t),this.events={},e&&e.on)for(var n=0,i=Object.entries(e.on);n<i.length;n++){var r=_(i[n],2),o=r[0],s=r[1];this.on(o,s)}}return y(t,[{key:"emit",value:function(t){this.interrupted=!1;var e=[].slice.call(arguments,1);if(this.events[t]){var n,i=T(this.events[t]);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.apply(void 0,S(e)),this.interrupted)return}}catch(t){i.e(t)}finally{i.f()}}}},{key:"interrupt",value:function(){this.interrupted=!0}},{key:"on",value:function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)}},{key:"prependOn",value:function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].unshift(e)}},{key:"unsubscribe",value:function(t,e){if(this.events[t]){var n=this.events[t].indexOf(e);this.events[t].splice(n,1)}}},{key:"resetEmitter",value:function(){this.events={}}},{key:"resetOn",value:function(t){this.events[t]=[]}}]),t}();var I=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t,e){
/*!
   * getStyleProperty v1.0.4
   * original by kangax
   * http://perfectionkills.com/feature-testing-css-properties/
   * MIT license
   */
var n,i;n="Webkit Moz ms Ms O".split(" "),i=document.documentElement.style,t.exports=function(t){if(t){if("string"==typeof i[t])return t;var e;t=t.charAt(0).toUpperCase()+t.slice(1);for(var r=0,o=n.length;r<o;r++)if(e=n[r]+t,"string"==typeof i[e])return e}}}));function C(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}function j(t){return function(e,n){return Math.sqrt(Math.pow(t.x*Math.abs(e.x-n.x),2)+Math.pow(t.y*Math.abs(e.y-n.y),2))}}function B(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n/C(t,e);return new M(t.x+o*i,t.y+o*r)}function N(t,e){var n=Math.min(t,e),i=Math.max(t,e);return Math.min(i-n,n+2*Math.PI-i)}function W(t){for(;t<0;)t+=2*Math.PI;for(;t>2*Math.PI;)t-=2*Math.PI;return t}var X=function(){function t(){v(this,t)}return y(t,[{key:"bound",value:function(t,e){return t}},{key:"refresh",value:function(){}}],[{key:"bounding",value:function(){var t=P(this,Array.prototype.slice.call(arguments));return t.bound.bind(t)}}]),t}(),q=function(t){m(n,t);var e=k(n);function n(t){var i;return v(this,n),(i=e.call(this)).rectangle=t,i}return y(n,[{key:"bound",value:function(t,e){var n=t.clone(),i=this.rectangle.getP3();return this.rectangle.position.x>n.x&&(n.x=this.rectangle.position.x),this.rectangle.position.y>n.y&&(n.y=this.rectangle.position.y),i.x<n.x+e.x&&(n.x=i.x-e.x),i.y<n.y+e.y&&(n.y=i.y-e.y),n}}]),n}(X),Y=function(t){m(n,t);var e=k(n);function n(t,i){var r;return v(this,n),(r=e.call(this,R.fromElement(t,i))).element=t,r.container=i,r}return y(n,[{key:"refresh",value:function(){this.rectangle=R.fromElement(this.element,this.container)}}]),n}(q),F=function(t){m(n,t);var e=k(n);function n(t,i){var r;v(this,n),(r=e.call(this)).startPoint=t,r.endPoint=i;var o=Math.atan2(i.y-t.y,i.x-t.x)+Math.PI/2;return r.someK=10,r.cosBeta=Math.cos(o),r.sinBeta=Math.sin(o),r}return y(n,[{key:"bound",value:function(t,e){var n,i,r,o,s,a,u,h,l,c,f,d,g,v,p,y,m,b=new M(t.x+this.someK*this.cosBeta,t.y+this.someK*this.sinBeta),x=B(this.endPoint,this.startPoint,e.x),w=(n=this.startPoint,i=this.endPoint,o=b,(r=t).x===o.x&&(s=r,r=n,n=s,s=o,o=i,i=s),n.x===i.x?(u=(o.y-r.y)/(o.x-r.x),l=(o.x*r.y-r.x*o.y)/(o.x-r.x),c=n.x,new M(c,c*u+l)):(a=(i.y-n.y)/(i.x-n.x),h=(i.x*n.y-n.x*i.y)/(i.x-n.x),u=(o.y-r.y)/(o.x-r.x),l=(o.x*r.y-r.x*o.y)/(o.x-r.x),new M(c=(h-l)/(u-a),c*a+h)));return f=this.startPoint,d=x,v=new M((g=w).x-f.x,g.y-f.y),p=new M(d.x-f.x,d.y-f.y),y=p.x*p.x+p.y*p.y,m=(v.x*p.x+v.y*p.y)/y,new M(f.x+p.x*m,f.y+p.y*m)}}]),n}(X),U=function(t){m(n,t);var e=k(n);function n(t,i,r,o){var s;return v(this,n),(s=e.call(this,t,i))._startAngle=r,s._endAngle=o,s}return y(n,[{key:"startAngle",value:function(){return"function"==typeof this._startAngle?this._startAngle():this._startAngle}},{key:"endAngle",value:function(){return"function"==typeof this._endAngle?this._endAngle():this._endAngle}},{key:"bound",value:function(t,e){var n,i,r,o,s,a=(n=this.center,i=t.sub(n),W(Math.atan2(i.y,i.x)));return a=W(a),r=this.startAngle(),o=this.endAngle(),s=a,function(t,e,n){return(n=n||new M(0,0)).add(new M(e*Math.cos(t),e*Math.sin(t)))}(a=r<o&&s>r&&s<o||o<r&&(s<o||s>r)?s:N(r,s)<N(o,s)?r:o,this.radius,this.center)}}]),n}(function(t){m(n,t);var e=k(n);function n(t,i){var r;return v(this,n),(r=e.call(this)).center=t,r.radius=i,r}return y(n,[{key:"bound",value:function(t,e){return B(this.center,t,this.radius)}}]),n}(X));function G(t,e){for(var n=0;n<t.length;n++)t[n]===e&&(t.splice(n,1),n--);return t}var H=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,t),this.rectangle=e,this.options=n}return y(t,[{key:"boundRect",get:function(){return"function"==typeof this.rectangle?this.rectangle():this.rectangle}}]),t}(),K=function(t){m(n,t);var e=k(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v(this,n),(i=e.call(this,t,r)).options=Object.assign({removable:!0},r),i.radius=r.radius||80,i.paddingTopLeft=r.paddingTopLeft||new M(0,0),i.paddingBottomRight=r.paddingBottomRight||new M(0,0),i.yGapBetweenDraggables=r.yGapBetweenDraggables||0,i.getDistance=r.getDistance||C,i.getPosition=r.getPosition||function(t){return t.position},i}return y(n,[{key:"positioning",value:function(t,e){var n=this,i=this.boundRect,r=i.getP2(),o=[i.position];return t.forEach((function(t,e){for(var s,a=!1,u=0;u<o.length&&!(a=(s=new M(o[u].x+n.paddingTopLeft.x,u>0?o[u-1].y+n.yGapBetweenDraggables:i.position.y+n.paddingTopLeft.y)).x+t.size.x<r.x);u++);a||(s=new M(i.position.x+n.paddingTopLeft.x,o[o.length-1].y+(e>0?n.yGapBetweenDraggables:n.paddingTopLeft.y))),t.position=s,n.options.removable&&t.getP3().y>i.getP3().y&&(t.removable=!0),o=function(t,e,n){for(var i=t.filter((function(t){return t.y>e.y||(n?t.x<e.x:t.x>e.x)})),r=0;r<i.length;r++)if(e.y<i[r].y)return i.splice(r,0,e),i;return i.push(e),i}(o,t.getP3().add(n.paddingBottomRight))})),t}},{key:"sorting",value:function(t,e,n){var i=this,r=t.concat(),o=t.map((function(t){return t.getPosition()}));return e.forEach((function(e){var n=function(t,e,n){var i,r,o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C,a=0;if(0===t.length)return-1;for(i=s(t[0],e),r=0;r<t.length;r++)(o=s(t[r],e))<i&&(i=o,a=r);return n>=0&&i>n?-1:a}(o,i.getPosition(e),i.radius,i.getDistance);n=-1===n?r.length:r.indexOf(t[n]),r.splice(n,0,e)})),e.forEach((function(t){n.push(r.indexOf(t))})),r}}]),n}(H),Z=function(t){m(n,t);var e=k(n);function n(t,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};v(this,n);var s=E(r=e.call(this,o));return r.options=Object.assign({timeEnd:200,timeExcange:400},o),r.positioningStrategy=o.strategy||new K(r.getRectangle.bind(E(r)),{radius:80,getDistance:j({x:1,y:4}),removable:!0}),r.element=t,i.forEach((function(t){return t.targets.push(s)})),r.draggables=i,n.emitter.emit("target:create",E(r)),r.startBounding(),r.init(),r}return y(n,[{key:"startBounding",value:function(){this.bound=this.options.bound||Y.bounding(this.element)}},{key:"positioning",value:function(t,e){return this.positioningStrategy.positioning(t,e)}},{key:"sorting",value:function(t,e,n){return this.positioningStrategy.sorting(t,e,n)}},{key:"init",value:function(){var t,e,n=this;this.innerDraggables=this.draggables.filter((function(t){for(var e=t.element.parentNode;e;){if(e===n.element)return!0;e=e.parentNode}return!1})),this.innerDraggables.length&&(e=function(t,e,n){var i=[];if(void 0===e&&(e=t,t=0),void 0===n&&(n=1),n>0&&t>=e||n<0&&t<=e)return[];for(var r=t;n>0?r<e:r>e;r+=n)i.push(r);return i}(this.innerDraggables.length),t=this.positioning(this.innerDraggables.map((function(t){return t.getRectangle()})),e),this.setPosition(t,e),this.innerDraggables.forEach((function(t){return n.emit("target:add",t)})))}},{key:"getRectangle",value:function(){return R.fromElement(this.element,this.container,!0)}},{key:"catchDraggable",value:function(t){if(this.options.catchDraggable)return this.options.catchDraggable(this,t);var e=this.getRectangle();return t.getRectangle().getSquare()<e.getSquare()&&e.includePoint(t.getCenter())}},{key:"getPosition",value:function(){return this.getRectangle().position}},{key:"getSize",value:function(){return this.getRectangle().size}},{key:"destroy",value:function(){var t=this;$.forEach((function(e){return G(e.targets,t)}))}},{key:"refresh",value:function(){var t=this.positioning(this.innerDraggables.map((function(t){return t.getRectangle()})),[]);this.setPosition(t,[],0)}},{key:"onEnd",value:function(t){var e=[];if(!this.getRectangle().includePoint(t.getCenter()))return!1;t.position=this.bound(t.position,t.getSize()),this.emit("target:beforeAdd",t),this.innerDraggables=this.sorting(this.innerDraggables,[t],e);var n=this.positioning(this.innerDraggables.map((function(t){return t.getRectangle()})),e);return this.setPosition(n,e),-1!==this.innerDraggables.indexOf(t)&&this.addRemoveOnMove(t),!0}},{key:"setPosition",value:function(t,e,n){var i=this;this.innerDraggables.slice(0).forEach((function(r,o){var s=t[o],a=n||0===n?n:-1!==e.indexOf(o)?i.options.timeEnd:i.options.timeExcange;s.removable?(r.move(r.initialPosition,a,!0,!0),G(i.innerDraggables,r),i.emit("target:remove",r)):r.move(s.position,a,!0,!0)}))}},{key:"add",value:function(t,e){var n=this.innerDraggables.length;this.emit("target:beforeAdd",t),this.pushInnerDraggable(t);var i=this.positioning(this.innerDraggables.map((function(t){return t.getRectangle()})),n,t);this.setPosition(i,[n],e||0),-1!==this.innerDraggables.indexOf(t)&&this.addRemoveOnMove(t)}},{key:"pushInnerDraggable",value:function(t){-1===this.innerDraggables.indexOf(t)&&this.innerDraggables.push(t)}},{key:"addRemoveOnMove",value:function(t){var e=this;t.on("drag:move",this.removeHandler=function(){e.remove(t)}),this.emit("target:add",t)}},{key:"remove",value:function(t){t.unsubscribe("drag:move",this.removeHandler);var e=this.innerDraggables.indexOf(t);if(-1!==e){this.innerDraggables.splice(e,1);var n=this.positioning(this.innerDraggables.map((function(t){return t.getRectangle()})),[]);this.setPosition(n,[]),this.emit("target:remove",t)}}},{key:"reset",value:function(){var t=this;this.innerDraggables.forEach((function(e){e.move(e.initialPosition,0,!0,!0),t.emit("target:remove",e)})),this.innerDraggables=[]}},{key:"getSortedDraggables",value:function(){this.innerDraggables.slice()}},{key:"container",get:function(){return this._container=this._container||this.options.container||this.options.parent||L(this.element)}}]),n}(z);Z.emitter=new z,Z.emitter.on("target:create",(function(t){V.addTarget(t)}));var $=[],J=function(t){m(n,t);var e=k(n);function n(t,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return v(this,n),r=e.call(this,o),$.forEach((function(e){t&&t.forEach((function(t){G(e.draggables,t)})),i&&i.forEach((function(t){G(e.targets,t)}))})),r.draggables=t||[],r.targets=i||[],$.push(E(r)),r.options={timeEnd:o.timeEnd||400},r.init(),r}return y(n,[{key:"init",value:function(){var t=this;this.draggables.forEach((function(e){e.dragEndAction=function(){return t.onEnd(e)}}))}},{key:"addDraggable",value:function(t){var e=this;this.draggables.push(t),t.dragEndAction=function(){return e.onEnd(t)}}},{key:"addTarget",value:function(t){this.targets.push(t)}},{key:"onEnd",value:function(t){var e=this.targets.filter((function(e){return-1!==e.draggables.indexOf(t)})).filter((function(e){return e.catchDraggable(t)})).sort((function(t,e){return t.getRectangle().getSquare()-e.getRectangle().getSquare()}));e.length?e[0].onEnd(t):t.targets.length&&t.pinPosition(t.initialPosition,this.options.timeEnd),this.emit("scope:change")}},{key:"reset",value:function(){this.targets.forEach((function(t){return t.reset()}))}},{key:"refresh",value:function(){this.draggables.forEach((function(t){return t.refresh()})),this.targets.forEach((function(t){return t.refresh()}))}},{key:"positions",get:function(){var t=this;return this.targets.map((function(e){return e.innerDraggables.map((function(e){return t.draggables.indexOf(e)}))}))},set:function(t){var e=this;if(t.length!==this.targets.length)throw"wrong array length";this.targets.forEach((function(t){return t.reset()})),t.forEach((function(t,n){t.forEach((function(t){e.targets[n].add(e.draggables[t])}))}))}}]),n}(z),V=new J;var Q=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){return t=!0}});window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){t=!1}return t}();var tt=function(t,e){var n,i,r,o=(n=function(e){return t(e)},i=e,r=0,function(){var t=this,e=arguments,o=Date.now();o-r>=i&&(n.apply(t,e),r=o)});return function(t){t.preventDefault(),o(t)}},et=!!Q&&{passive:!1},nt="ontouchstart"in window,it="mousedown",rt="mousemove",ot="mouseup",st="touchstart",at="touchmove",ut="touchend",ht=[],lt=I("transform"),ct=I("transition");function ft(t,e){for(var n=0;n<t.changedTouches.length;n++)if(t.changedTouches[n].identifier===e)return t.changedTouches[n];return!1}function dt(t){if(ht.some((function(e){return t.element===e.element})))throw"for this element Dragee.Draggable is already exist, don't create it twice ";ht.push(t)}function gt(t,e){for(var n=window.getComputedStyle(t),i=0;i<n.length;i++){var r=n[i];r.indexOf("transition")<0&&r.indexOf("transform")<0&&(e.style[r]=n[r])}for(var o=0;o<t.children.length;o++)gt(t.children[o],e.children[o])}var vt,pt=function(t){m(n,t);var e=k(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v(this,n),(i=e.call(this,r)).targets=[],i.options=r,i.element=t,dt(E(i)),n.emitter.emit("draggable:create",E(i)),i._enable=!0,i.startBounding(),i.startPositioning(),i.startListening(),i}return y(n,[{key:"startBounding",value:function(){this.options.bound?this.bounding={bound:this.options.bound}:this.bounding=new Y(this.container,this.container)}},{key:"startPositioning",value:function(){this._setDefaultTransition(),this.offset=M.elementOffset(this.element,this.container,!0),this.pinnedPosition=this.offset,this.position=this.offset,this.initialPosition=this.options.position||this.offset,this.pinPosition(this.initialPosition),this.bounding.refresh&&this.bounding.refresh()}},{key:"startListening",value:function(){var t=this;this._dragStart=function(e){return t.dragStart(e)},this._dragMove=function(e){return t.dragMove(e)},this._dragEnd=function(e){return t.dragEnd(e)},this._nativeDragStart=function(e){return t.nativeDragStart(e)},this._nativeDragOver=tt((function(e){return t.nativeDragOver(e)}),this.dragOverThrottleDuration),this._nativeDragEnd=function(e){return t.nativeDragEnd(e)},this._nativeDrop=function(e){return t.nativeDrop(e)},this._scroll=function(e){return t.onScroll(e)},this.handler.addEventListener(st,this._dragStart,et),this.handler.addEventListener(it,this._dragStart,et),this.element.addEventListener("dragstart",this._nativeDragStart)}},{key:"getSize",value:function(){return M.elementSize(this.element)}},{key:"getPosition",value:function(){return this.position=this.offset.add(this._transformPosition||new M(0,0)),this.position}},{key:"getCenter",value:function(){return this.position.add(this.getSize().mult(.5))}},{key:"_setDefaultTransition",value:function(){this.element.style[ct]||(this.element.style[ct]=window.getComputedStyle(this.element)[ct])}},{key:"_setTransition",value:function(t){var e=this.element.style[ct],n="transform ".concat(t,"ms");/transform \d*m?s/.test(e)?e=e.replace(/transform \d*m?s/g,n):e?e+=", ".concat(n):e=n,this.element.style[ct]!==e&&(this.element.style[ct]=e)}},{key:"_setTranslate",value:function(t){this._transformPosition=t;var e="translate3d(".concat(t.x,"px, ").concat(t.y,"px, 0px)"),n=this.element.style[lt];this.shouldRemoveZeroTranslate&&0===t.x&&0===t.y?n=n.replace(/translate3d\([^)]+\)/,""):/translate3d\([^)]+\)/.test(n)?n=n.replace(/translate3d\([^)]+\)/,e):(n&&(n+=" "),n+=e),this.element.style[lt]!==n&&(this.element.style[lt]=n)}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=t.clone(),this.position=t,this._setTransition(e),this._setTranslate(t.sub(this.offset)),n||this.emit("drag:move")}},{key:"pinPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.pinnedPosition=t.clone(),this.move(this.pinnedPosition,e,n)}},{key:"resetPositionToInitial",value:function(){this.pinPosition(this.initialPosition)}},{key:"refreshPosition",value:function(){this.setPosition(this.getPosition())}},{key:"setPosition",value:function(t){t=t.clone(),this.position=t,this._setTransition(0),this._setTranslate(t.sub(this.offset))}},{key:"determineDirection",value:function(t){this._previousDirectionPosition||(this._previousDirectionPosition=this._startPosition),this.leftDirection=this._previousDirectionPosition.x<t.x,this.rightDirection=this._previousDirectionPosition.x>t.x,this.upDirection=this._previousDirectionPosition.y>t.y,this.downDirection=this._previousDirectionPosition.y<t.y,this._previousDirectionPosition=t}},{key:"seemsScrolling",value:function(){return+new Date-this._startTouchTimestamp<this.touchDraggingThreshold}},{key:"shouldUseNativeDragAndDrop",value:function(){return this.isTouchEvent?this.nativeDragAndDrop&&this.emulateNativeDragAndDropOnTouch:this.nativeDragAndDrop}},{key:"dragStart",value:function(t){var e=this;if(this._enable){if(this.isTouchEvent=nt&&t instanceof window.TouchEvent,this.touchPoint=this._startTouchPoint=new M(this.isTouchEvent?t.changedTouches[0].pageX:t.clientX,this.isTouchEvent?t.changedTouches[0].pageY:t.clientY),this._startPosition=this.getPosition(),this.isTouchEvent&&(this._touchId=t.changedTouches[0].identifier,this._startTouchTimestamp=+new Date),this._startWindowScrollPoint=this.windowScrollPoint,this._startParentsScrollPoint=this.parentsScrollPoint,(t.target instanceof window.HTMLInputElement||t.target instanceof window.HTMLInputElement)&&t.target.focus(),this.shouldUseNativeDragAndDrop())if(this.isTouchEvent&&this.emulateNativeDragAndDropOnTouch){var n=function(t){e.seemsScrolling()?e.cancelDragging():e.emulateNativeDragAndDrop(t),i()},i=function t(){document.removeEventListener(at,n),document.removeEventListener(ut,t)};document.addEventListener(at,n,et),document.addEventListener(ut,i,et)}else this.element.draggable=!0,document.addEventListener(ot,this._nativeDragEnd,et);else document.addEventListener(at,this._dragMove,et),document.addEventListener(rt,this._dragMove,et),document.addEventListener(ut,this._dragEnd,et),document.addEventListener(ot,this._dragEnd,et);window.addEventListener("scroll",this._scroll),this.parents.forEach((function(t){return t.addEventListener("scroll",e._scroll)})),this.emit("drag:start")}}},{key:"dragMove",value:function(t){var e;if(this.isDragging=!0,this.isTouchEvent=nt&&t instanceof window.TouchEvent,this.isTouchEvent){if(!(e=ft(t,this._touchId)))return;if(this.seemsScrolling())return void this.cancelDragging()}t.stopPropagation(),t.preventDefault(),this.touchPoint=new M(this.isTouchEvent?e.pageX:t.clientX,this.isTouchEvent?e.pageY:t.clientY);var n=this._startPosition.add(this.touchPoint.sub(this._startTouchPoint)).add(this.windowScrollPoint.sub(this._startWindowScrollPoint)).add(this.parentsScrollPoint.sub(this._startParentsScrollPoint));n=this.bounding.bound(n,this.getSize()),this.determineDirection(n),this.move(n),this.element.classList.add("dragee-active")}},{key:"dragEnd",value:function(t){var e=this;this.isTouchEvent=nt&&t instanceof window.TouchEvent,this.isTouchEvent&&!ft(t,this._touchId)||(this.isDragging&&(t.stopPropagation(),t.preventDefault()),this.dragEndAction(),this.emit("drag:end"),this.cancelDragging(),setTimeout((function(){return e.element.classList.remove("dragee-active")})))}},{key:"onScroll",value:function(t){var e=this._startPosition.add(this.touchPoint.sub(this._startTouchPoint)).add(this.windowScrollPoint.sub(this._startWindowScrollPoint)).add(this.parentsScrollPoint.sub(this._startParentsScrollPoint));e=this.bounding.bound(e,this.getSize()),this.nativeDragAndDrop||(this.determineDirection(e),this.move(e))}},{key:"nativeDragStart",value:function(t){t.dataTransfer.setData("text","FireFox fix"),t.dataTransfer.effectAllowed="move",document.addEventListener("dragover",this._nativeDragOver),document.addEventListener("dragend",this._nativeDragEnd),document.addEventListener("drop",this._nativeDrop)}},{key:"nativeDragOver",value:function(t){if(t.preventDefault(),t.dataTransfer.dropEffect="move",this.element.classList.add("dragee-placeholder"),0!==t.clientX||0!==t.clientY){this.touchPoint=new M(t.clientX,t.clientY);var e=this._startPosition.add(this.touchPoint.sub(this._startTouchPoint)).add(this.windowScrollPoint.sub(this._startWindowScrollPoint)).add(this.parentsScrollPoint.sub(this._startParentsScrollPoint));e=this.bounding.bound(e,this.getSize()),this.determineDirection(e),this.position=e,this.emit("drag:move")}}},{key:"nativeDragEnd",value:function(t){var e=this;this.element.classList.remove("dragee-placeholder"),this.dragEndAction(),this.emit("drag:end"),document.removeEventListener("dragover",this._nativeDragOver),document.removeEventListener("dragend",this._nativeDragEnd),document.removeEventListener(ot,this._nativeDragEnd),document.removeEventListener("drop",this._nativeDrop),window.removeEventListener("scroll",this._scroll),this.parents.forEach((function(t){return t.removeEventListener("scroll",e._scroll)})),this.isDragging=!1,this.element.removeAttribute("draggable"),this.element.classList.remove("dragee-active")}},{key:"nativeDrop",value:function(t){t.stopPropagation(),t.preventDefault()}},{key:"cancelDragging",value:function(){var t=this;document.removeEventListener(at,this._dragMove),document.removeEventListener(rt,this._dragMove),document.removeEventListener(ut,this._dragEnd),document.removeEventListener(ot,this._dragEnd),document.removeEventListener(ot,this._nativeDragEnd),window.removeEventListener("scroll",this._scroll),this.parents.forEach((function(e){return e.removeEventListener("scroll",t._scroll)})),this.isDragging=!1,this._previousDirectionPosition=null,this.element.removeAttribute("draggable")}},{key:"copyStyles",value:function(t,e){this.options.copyStyles?this.options.copyStyles(t,e):gt(t,e)}},{key:"emulateNativeDragAndDrop",value:function(t){var e=this,i=this.container.getBoundingClientRect(),r=this.element.cloneNode(!0);r.style[lt]="",this.copyStyles(this.element,r),r.style.position="absolute",document.body.appendChild(r),this.element.classList.add("dragee-placeholder");var o=new n(r,{container:document.body,touchDraggingThreshold:0,bound:function(t){return t},on:{"drag:move":function(){var t=new M(i.left,i.top);e.position=o.position.sub(t).sub(e._startWindowScrollPoint).add(e._startParentsScrollPoint),e.determineDirection(e.position),e.emit("drag:move")},"drag:end":function(){o.destroy(),document.body.removeChild(r),e.element.classList.remove("dragee-placeholder"),e.element.classList.remove("dragee-active"),e.emit("drag:end"),e.dragEndAction(),e.cancelDragging()}}}),s=new M(i.left,i.top);o._startWindowScrollPoint=this._startWindowScrollPoint,o.move(this.pinnedPosition.add(s).add(this.windowScrollPoint).sub(this.parentsScrollPoint)),o.dragStart(t),t.preventDefault()}},{key:"dragEndAction",value:function(){this.pinPosition(this.position)}},{key:"getRectangle",value:function(){return new R(this.position,this.getSize())}},{key:"refresh",value:function(){this.bounding.refresh&&this.bounding.refresh()}},{key:"destroy",value:function(){this.handler.removeEventListener(st,this._dragStart),this.handler.removeEventListener(it,this._dragStart),this.element.removeEventListener("dragstart",this._nativeDragStart),document.removeEventListener(at,this._dragMove),document.removeEventListener(rt,this._dragMove),document.removeEventListener(ut,this._dragEnd),document.removeEventListener(ot,this._dragEnd),document.removeEventListener("dragover",this._nativeDragOver),document.removeEventListener("dragend",this._nativeDragEnd),document.removeEventListener(ot,this._nativeDragEnd),document.removeEventListener("drop",this._nativeDrop),this.resetEmitter();var t=ht.indexOf(this);t>-1&&ht.splice(t,1)}},{key:"container",get:function(){return this._container=this._container||this.options.container||this.options.parent||L(this.element)}},{key:"handler",get:function(){return this._handler||("string"==typeof this.options.handler?this._handler=this.element.querySelector(this.options.handler)||this.element:this._handler=this.options.handler||this.element),this._handler}},{key:"nativeDragAndDrop",get:function(){return this.options.nativeDragAndDrop||!1}},{key:"emulateNativeDragAndDropOnTouch",get:function(){return this.options.emulateNativeDragAndDropOnTouch||!1}},{key:"shouldRemoveZeroTranslate",get:function(){return this.options.shouldRemoveZeroTranslate||!1}},{key:"touchDraggingThreshold",get:function(){return this.options.touchDraggingThreshold||0}},{key:"dragOverThrottleDuration",get:function(){return this.options.dragOverThrottleDuration||16}},{key:"windowScrollPoint",get:function(){return new M(window.scrollX,window.scrollY)}},{key:"parents",get:function(){if(this._cachedParents)return this._cachedParents;this._cachedParents=[];for(var t=this.element;t.parentNode&&t!=this.container;)this._cachedParents.unshift(t.parentNode),t=t.parentNode;return this._cachedParents}},{key:"parentsScrollPoint",get:function(){return new M(this.parents.reduce((function(t,e){return t+e.scrollLeft}),0),this.parents.reduce((function(t,e){return t+e.scrollTop}),0))}},{key:"enable",get:function(){return this._enable},set:function(t){t?this.element.classList.remove("dragee-disable"):this.element.classList.add("dragee-disable"),this._enable=t}}]),n}(z);pt.emitter=new z,pt.emitter.on("draggable:create",(function(t){V.addDraggable(t)})),function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(vt||(vt={}));var yt=function(t){return Object.freeze(t)},mt=function(t,e){this.inlineSize=t,this.blockSize=e,yt(this)},bt=function(){function t(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,yt(this)}return t.prototype.toJSON=function(){var t=this;return{x:t.x,y:t.y,top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}},t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t}(),xt="undefined"!=typeof window?window:{};/msie|trident/i.test(xt.navigator&&xt.navigator.userAgent);var wt=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=!1),new mt((n?e:t)||0,(n?t:e)||0)};function Pt(t,e){var n=e.sub(t);return Dt(Math.atan2(n.y,n.x))}function Et(t){return t%360*Math.PI/180}function Dt(t){for(;t<0;)t+=2*Math.PI;for(;t>2*Math.PI;)t-=2*Math.PI;return t}function kt(t,e,n){return(n=n||new M(0,0)).add(new M(e*Math.cos(t),e*Math.sin(t)))}yt({devicePixelContentBoxSize:wt(),borderBoxSize:wt(),contentBoxSize:wt(),contentRect:new bt(0,0,0,0)});var _t=function(){function t(n,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e(this,t);var o=R.fromElement(n,n);this.options=Object.assign({angle:0,dAngle:2*Math.PI/i.length,center:o.getCenter(),startRadius:50,endRadius:o.getMinSide()/2,lineWidth:2,strokeStyle:"#ff5577",fillStyle:"rgba(150,255,50,0.8)"},r),this.area=n,this.areaRectangle=o,this.init(i)}return i(t,[{key:"init",value:function(t){var e=this;this.canvas=g(this.area,this.areaRectangle),this.context=this.canvas.getContext("2d"),this.draggables=t.map((function(t,n){var i=e.options.angle+n*e.options.dAngle,r=M.elementSize(t).mult(.5),o=kt(i,e.options.startRadius,e.options.center).sub(r),s=kt(i,e.options.endRadius,e.options.center).sub(r);return new pt(t,{container:e.area,bound:F.bounding(o,s),position:o,on:{"drag:move":function(){return e.draw()}}})})),this.isInit=!0,this.draw()}},{key:"draw",value:function(){if(this.isInit){this.context.clearRect(0,0,this.areaRectangle.size.x,this.areaRectangle.size.y),this.context.beginPath();var t=this.draggables[0].getCenter();this.context.moveTo(t.x,t.y);for(var e=0;e<this.draggables.length;e++)t=this.draggables[e].getCenter(),this.context.lineTo(t.x,t.y);this.context.closePath(),this.context.lineWidth=this.options.lineWidth,this.context.strokeStyle=this.options.strokeStyle,this.context.stroke(),this.context.fillStyle=this.options.fillStyle,this.context.fill()}}}]),t}(),St=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e(this,t),this.events={},n&&n.on)for(var i=0,r=Object.entries(n.on);i<r.length;i++){var o=h(r[i],2),s=o[0],a=o[1];this.on(s,a)}}return i(t,[{key:"emit",value:function(t){this.interrupted=!1;var e=[].slice.call(arguments,1);if(this.events[t]){var n,i=d(this.events[t]);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.apply.apply(r,l(e)),this.interrupted)return}}catch(t){i.e(t)}finally{i.f()}}}},{key:"interrupt",value:function(){this.interrupted=!0}},{key:"on",value:function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)}},{key:"prependOn",value:function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].unshift(e)}},{key:"unsubscribe",value:function(t,e){if(this.events[t]){var n=this.events[t].indexOf(e);this.events[t].splice(n,1)}}},{key:"resetEmitter",value:function(){this.events={}}},{key:"resetOn",value:function(t){this.events[t]=[]}}]),t}(),At=function(t){r(o,t);var n=u(o);function o(t,i){var r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e(this,o),r=n.call(this,s);var a=R.fromElement(t,t);return r.options=Object.assign({center:a.getCenter(),radius:a.getMinSide()/2,startAngle:Math.PI,endAngle:0,angles:[Math.PI,-Math.PI/4,0,Math.PI/4,Math.PI/2],time:500},s),r.shiftedCenter=r.options.center,r.area=t,r.init(i),r}return i(o,[{key:"init",value:function(t){var e=this,n=this.options.startAngle,i=kt(n,this.options.radius,this.shiftedCenter);this.angle=n,this.draggable=new pt(t,{container:this.area,bound:U.bounding(this.shiftedCenter,this.options.radius,this.options.startAngle,this.options.endAngle),position:i,on:{"drag:move":function(){return e.change()}}})}},{key:"updateAngle",value:function(){this.angle=Pt(this.shiftedCenter,this.draggable.position)}},{key:"change",value:function(){this.updateAngle(),this.emit("arcslider:change",{angle:this.angle})}},{key:"setAngle",value:function(t,e){var n=kt(this.angle,this.options.radius,this.shiftedCenter);this.angle=Dt(t),this.draggable.pinPosition(n,e||0),this.emit("arcslider:change",this.angle)}}]),o}(St);function Ot(t,e,n){var i=[];if(void 0===e&&(e=t,t=0),void 0===n&&(n=1),n>0&&t>=e||n<0&&t<=e)return[];for(var r=t;n>0?r<e:r>e;r+=n)i.push(r);return i}var Tt=function(){return Math.round(255*Math.random())},Mt=function(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e};function Rt(){return"#".concat(Mt(Tt())).concat(Mt(Tt())).concat(Mt(Tt()))}var Lt=function(t){r(o,t);var n=u(o);function o(t,i){var r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e(this,o),r=n.call(this,s);var a=R.fromElement(t,t);return r.options=Object.assign({center:a.getCenter(),radius:a.getMinSide()/2,touchRadius:a.getMinSide()/2,boundAngle:Math.PI/9,fillStyles:Ot(0,i.length).map((function(){return Rt()})),initAngles:Ot(-90,270,360/i.length).map((function(t){return Et(t)})),limitImg:null,limitImgOffset:new M(0,0)},s),r.area=t,r.areaRectangle=a,r.init(i),r}return i(o,[{key:"init",value:function(t){var e=this;this.canvas=g(this.area,this.areaRectangle),this.context=this.canvas.getContext("2d"),this.draggables=t.map((function(t,n){var i=e.options.initAngles[n],r=M.elementSize(t).mult(.5),o=kt(i,e.options.touchRadius,e.options.center.sub(r));return new pt(t,{container:e.area,bound:U.bounding(e.options.center.sub(r),e.options.touchRadius,e.getBoundAngle(n,!1),e.getBoundAngle(n,!0)),position:o,on:{"drag:move":function(){return e.draw()}}})})),this.isInit=!0,this.draw()}},{key:"updateAngles",value:function(){var t=this;this.angles=this.draggables.map((function(e){var n=e.getSize().mult(.5);return Pt(t.options.center.sub(n),e.position)}))}},{key:"getBoundAngle",value:function(t,e){var n=this,i=e?1:-1;return function(){var e=(t+i)%n.angles.length;return e<0&&(e+=n.angles.length),Dt(n.angles[e]-i*n.options.boundAngle)}}},{key:"draw",value:function(){var t=this;this.isInit&&(this.updateAngles(),this.context.clearRect(0,0,this.areaRectangle.size.x,this.areaRectangle.size.y),this.draggables.forEach((function(e,n){t.drawArc(t.context,t.options.center,t.options.radius,n)})),this.draggables.forEach((function(e,n){t.drawLimitImg(n)})),this.emit("chart:draw"))}},{key:"createClone",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isInit){var i=R.fromElement(t,t),r=Object.assign({center:i.getCenter(),radius:i.getMinSide()/2,fillStyles:this.options.fillStyles},n),o=g(t,i),s=o.getContext("2d"),a={draw:function(){s.clearRect(0,0,i.size.x,i.size.y),e.draggables.forEach((function(t,n){e.drawArc(s,r.center,r.radius,n)}))}};return a.draw(),a}}},{key:"getFillStyle",value:function(t){return"function"==typeof this.options.fillStyles[t]&&(this.options.fillStyles[t]=this.options.fillStyles[t].call(this)),this.options.fillStyles[t]}},{key:"drawArc",value:function(t,e,n,i){var r=this.angles[i],o=this.angles[(i+1)%this.angles.length],s=this.getFillStyle(i);t.beginPath(),t.moveTo(e.x,e.y),t.arc(e.x,e.y,n,r,o,!1),t.lineTo(e.x,e.y),t.closePath(),t.fillStyle=s,t.fill()}},{key:"drawLimitImg",value:function(t){var e,n;if(this.options.limitImg&&(n=this.options.limitImg instanceof Array?this.options.limitImg[t]:this.options.limitImg),n){var i=Dt(this.angles[t]);e=(e=new M(0,-n.height/2)).add(this.options.limitImgOffset),this.context.translate(this.areaRectangle.size.x/2,this.areaRectangle.size.y/2),this.context.rotate(i),this.context.drawImage(n,e.x,e.y),this.context.setTransform(1,0,0,1,0,0)}}},{key:"getAnglesDiff",value:function(){var t=this.angles.slice(1),e=this.angles[0];return t.push(e),t.map((function(t){var n=Dt(t-e);return e=t,n}))}},{key:"getPercent",value:function(){return this.getAnglesDiff().map((function(t){return t/(2*Math.PI)}))}},{key:"getArcBisectrixs",value:function(){var t=this;return this.getAnglesDiff().map((function(e,n){return Dt(t.angles[n]+e/2)}))}},{key:"getArcOnPoint",value:function(t){var e=Pt(this.options.center,t);if(C(this.options.center,t)>this.options.radius)return-1;var n,i,r=-1;for(n=0;n<this.angles.length;n++)(-1===r||this.angles[r]>this.angles[n])&&(r=n);for(n=0,i=r;n<this.angles.length&&!(e<this.angles[i]);i=(++n+r)%this.angles.length);return--i<0&&(i+=this.angles.length),i}},{key:"setAngles",value:function(t){var e=this;this.angles=t,this.draggables.forEach((function(t,n){var i=e.angles[n],r=t.getSize().mult(.5),o=kt(i,e.options.touchRadius,e.options.center.sub(r));t.moveAndSave(o)})),this.draw()}},{key:"setActiveArc",value:function(t){var e=function(t,e){var n=[];return-1!==t&&(n.push(t),n.push((t+1)%e)),n}(t,this.draggables.length);this.activeArcIndex=t,this.draggables.forEach((function(t,n){t.enable=-1!==e.indexOf(n)})),this.draw()}}]),o}(St);t.ArcSlider=At,t.Chart=Lt,t.Spider=_t}));
